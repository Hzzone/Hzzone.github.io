<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <title>理解 PyTorch 计算图、Autograd 机制和实现线性拟合</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="shortcut icon" href="https://tuchuang-1252747889.cos.ap-guangzhou.myqcloud.com/hzzoneio_favicon.ico" />
        <!--<link rel="stylesheet" type="text/css" href="css/aircloud.css">-->
        <link rel="stylesheet" type="text/css" href="/static/css/aircloud.css">
        <link rel="stylesheet" type="text/css" href="/static/css/next.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/3.0.1/github-markdown.min.css" />
        <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/default.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/xcode.min.css">
        <script type="text/javascript" defer src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script async src="https:////busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <link rel="stylesheet" href="/static/css/iconfont.css">
        <script src="/static/js/iconfont.js"></script>
        <!--<link href="https://cdn.bootcss.com/font-awesome/5.8.2/css/fontawesome.min.css" rel="stylesheet">-->
        <!--<link href="https://cdn.bootcss.com/font-awesome/5.8.2/css/all.min.css" rel="stylesheet">-->
    </head>

    <body>
        <div id="progress-bar"></div>
        <div class="site-nav-toggle" id="site-nav-toggle">
            <button>
                <span class="btn-bar"></span>
                <span class="btn-bar"></span>
                <span class="btn-bar"></span>
            </button>
        </div>
        <div class="index-about">
            <i>To be talented & positive.</i>
        </div>
        <div class="index-container">
            <div class="index-left">
                <div class="nav" id="nav">
                    <div class="avatar-name">
                        <div class="avatar">
                            <img src="https://avatars2.githubusercontent.com/u/19267349"></div>
                        <div class="name">
                            <i>Zhizhong Huang</i>
                        </div>
                    </div>
                    <div class="contents" id="nav-content">
                        <ul>
                            <li style="padding-left: 10px;">
                                <a href="/">
                                    <!--<i class="fa fa-fw fa-home"></i>-->
                                    <!--<span class="iconfont icon-zhihu"></span>-->
                                    <!--<i class="iconfont icon-home"></i>-->
                                    <span>主页</span>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/Hzzone">
                                    <i class="iconfont icon-github"></i>
                                </a>
                                <a href="https://www.zhihu.com/people/hzzone">
                                    <i class="iconfont icon-zhihu"></i>
                                </a>
                            </li>
                            <!--<li>-->
                                <!--<a href="https://github.com/Hzzone">-->
                                    <!--&lt;!&ndash;<i class="fab fa-github"></i>&ndash;&gt;-->
                                    <!--<i class="iconfont icon-github"></i>-->
                                    <!--<span>Github</span></a>-->
                            <!--</li>-->
                            <!--<li>-->
                                <!--<a href="https://www.zhihu.com/people/hzzone">-->
                                    <!--&lt;!&ndash;<i class="fa fa-fw fa-zhihu"></i>&ndash;&gt;-->
                                    <!--<i class="iconfont icon-zhihu"></i>-->
                                    <!--<span>知乎</span>-->
                                <!--</a>-->
                            <!--</li>-->
                        </ul>
                    </div>
                    <!--<div id="toc" class="toc-article toc-fixed" style="height: 823px; overflow-y: scroll;">-->
                        <!--<ol class="toc">-->
                            <!--<li class="toc-item toc-level-3 active">-->
                                <!--<a class="toc-link" href="#目前遇到的问题">-->
                                    <!--<span class="toc-text">目前遇到的问题</span></a>-->
                            <!--</li>-->
                            <!--<li class="toc-item toc-level-3">-->
                                <!--<a class="toc-link" href="#问题归纳与解决">-->
                                    <!--<span class="toc-text">问题归纳与解决</span></a>-->
                            <!--</li>-->
                            <!--<li class="toc-item toc-level-3">-->
                                <!--<a class="toc-link" href="#更多">-->
                                    <!--<span class="toc-text">更多</span></a>-->
                            <!--</li>-->
                        <!--</ol>-->
                    <!--</div>-->
                </div>
                <div class="index-about-mobile">
                    <i>To be talented & positive.</i>
                </div>
            </div>
            <div class="content-wrap">
                <!-- Main Content -->
                <div class="post-container">
  <div class="post-title">理解 PyTorch 计算图、Autograd 机制和实现线性拟合</div>
  <div class="post-meta">
    <span class="attr">发布于：
      <span>2019-06-12 13:17:49</span>
    </span>
    <span class="attr">标签：
      <span>cs231n</span>
      </span>
    <span class="attr">访问：
      <span id="busuanzi_value_page_pv">1368</span></span>
  </div>
    <div class="markdown-body post-content post_href">
        
        <h4>
          <a href="https://nbviewer.jupyter.org/github/Hzzone/hzzone.github.io/blob/source/3. cs231n/理解 PyTorch 计算图、Autograd 机制和实现线性拟合.ipynb">Notebook 地址</a>
        </h4>
        
        <h3>参考</h3>
<ul>
<li><a href="http://www.cnblogs.com/armysheng/p/3422923.html">机器学习经典算法之-----最小二乘法</a></li>
<li><a href="https://pytorch.org/docs/stable/notes/autograd.html">Autograd mechanics</a></li>
<li><a href="https://blog.csdn.net/u013527419/article/details/70184690">计算图（computational graph）角度看BP（back propagation）算法</a></li>
<li><a href="https://blog.csdn.net/manong_wxd/article/details/78734358">PyTorch学习总结(七)——自动求导机制</a></li>
<li><a href="https://pytorch-cn.readthedocs.io/zh/latest/notes/autograd/">自动求导机制</a></li>
</ul>
<h3>计算图</h3>
<p>启发于 cs231n 的 <a href="http://cs231n.stanford.edu/syllabus.html">Deep Learning Hardware and Software</a>，课程在里面介绍了 pytorch 的自动求导机制和动态计算图。</p>
<p>我们都知道梯度下降和反向传播需要求解每一层的梯度，以更新权重。<a href="https://github.com/BVLC/caffe/tree/master/src/caffe/layers">Caffe Layers</a> 采用的机制是对每一层都定义一个 <code>backward</code> 和 <code>forward</code> 操作，然后在这两个函数中前馈、计算梯度等。</p>
<p>Computational Graph 指的是一系列的操作，包括输出的数据。</p>
<p>例如课程中的例子，利用 PyTorch 自动求导机制求 x, y 的梯度和 numpy 对比，中间则是计算图，实现的是 $c=\sum{(x*y+z)}$。</p>
<p><img src="https://tuchuang-1252747889.cosgz.myqcloud.com/2018-11-25-123659.png" alt=""></p>
<p>TensorFlow 的数据流图的例子，数据经过节点被处理，然后输出，就像水一样流动:</p>
<p><img src="https://tuchuang-1252747889.cosgz.myqcloud.com/2018-11-25-tensors_flowing.jpg" alt=""></p>
<p>**Pytorch 是动态图，每一次训练，都会销毁图并重新创建，这样做花销很大，但是更加灵活。**而 Tensorflow 是静态图，一旦定义训练时就不能修改。Pytorch 合并 caffe2 发布 1.0 版本之后引入静态图，而 Tensorflow 已经发布 <a href="https://www.tensorflow.org/guide/eager">Eager Execution</a> 引入动态图。但相对来说还是 Pytorch 更加灵活。</p>
<h3>Autograd mechanics</h3>
<p>首先要知道，Pytorch 的数据和参数（权重、偏置等）都是以 Tensor 存储的，Pytorch 的 Tensor 相当于 caffe 的 Blob，Tensorflow 的 Tensor。Pytorch 已经定义了 Tensor 的很多操作，可以在 GPU 上运算加速。</p>
<p>Pytorch 会自动跟踪计算图的操作，在计算图执行完成后，调用 <code>backward</code> 计算梯度。很久以前数据需要使用 <code>Variable</code> 封装，像这样的:</p>
<p><img src="https://tuchuang-1252747889.cosgz.myqcloud.com/2018-11-25-68960-7084a4be66464e40.png" alt=""></p>
<p>data 存储数据，grad 存储梯度，creator 指向创建者。</p>
<p>现在不用这么麻烦了，直接合并 Tensor 和 Variable，只需要 <code>requires_grad=True</code> 表明需要计算梯度。</p>
<p>需要注意: <strong>只有当任意一个输入的 Tensor 不需要计算梯度时，输出才不需要计算梯度；如果有一个需要计算，输出就需要。</strong></p>
<pre class="hljs"><code><span class="hljs-keyword">import</span> torch
x = torch.randn(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>)
y = torch.randn(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>)
z = x + y
z.requires_grad
</code></pre>
<pre><code>False
</code></pre>
<pre class="hljs"><code>x = torch.randn(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>, requires_grad=<span class="hljs-literal">True</span>)
y = torch.randn(<span class="hljs-number">5</span>, <span class="hljs-number">5</span>)
z = x + y
z.requires_grad
</code></pre>
<pre><code>True
</code></pre>
<p>实现自定义的 Tensor 自动求导需要实现 <code>forward</code> 和 <code>backward</code>，例如 cs231n 的例子:</p>
<p><img src="https://tuchuang-1252747889.cosgz.myqcloud.com/2018-11-25-%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-11-25%20%E4%B8%8B%E5%8D%889.10.56.png" alt=""></p>
<p><code>backward</code> 之后更新完参数需要清除梯度，<code>torch.no_grad</code> 是指在此的计算不创建图的节点。</p>
<h3>实现线性拟合</h3>
<p>线性拟合是初中的知识，很简单，就是用一条直线拟合一些点，并使得点到直线的距离之和最短。常用最小二乘法求解，这里使用梯度下降（虽然线性拟合有公式直接求解）。点到直线的距离公式:</p>
<p>$$
d = \left| \frac { A x _ { 0 } + B y _ { 0 } + C } { \sqrt { A ^ { 2 } + B ^ { 2 } } } \right|
$$</p>
<p>接下来我就生成一些点，并假设直线为 $y=ax+b$，那么点到直线的距离为:</p>
<p>$$
d = \left| \frac { a x _ { 0 } - y _ { 0 } + b } { \sqrt { a ^ { 2 } + 1 } } \right|
$$</p>
<p>因此定义损失函数为:</p>
<p>$$
L = \frac{1}{2N}\sum_i \frac{(a x _ { i } - y _ { i } + b)^2}{a^2+1}
$$</p>
<p>显然可以对 $L$ 直接求导，但是这个公式直接对 $a$ 和 $b$ 求偏导太麻烦，最后的结果很复杂，可能这就是距离公式常用 MSE 和 MAE 的原因。但是我可以用 Pytorch 的计算图自动求导解决。</p>
<p>生成一些随机点:</p>
<pre class="hljs"><code><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> random
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-comment"># 在0-2*pi的区间上生成100个点作为输入数据</span>
X = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>,endpoint=<span class="hljs-literal">True</span>)
a, b = <span class="hljs-number">2.5</span>, <span class="hljs-number">1.0</span>
Y = a*X+b

<span class="hljs-comment"># 对输入数据加入gauss噪声</span>
<span class="hljs-comment"># 定义gauss噪声的均值和方差</span>
mu = <span class="hljs-number">0</span>
sigma = <span class="hljs-number">2</span>
Nx, Ny = X.copy(), Y.copy()
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(X.shape[<span class="hljs-number">0</span>]):
    Nx[i] += random.gauss(mu,sigma)
    Ny[i] += random.gauss(mu,sigma)

<span class="hljs-comment"># 画出这些点</span>
plt.plot(X, Y)
plt.scatter(Nx, Ny, marker=<span class="hljs-string">'.'</span>, color=<span class="hljs-string">'r'</span>)
plt.show()
</code></pre>
<p><img src="data:image/png;base64,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" alt="png"></p>
<p>接下来就是一系列计算然后更新 $a$ 和 $b$ 了。</p>
<pre class="hljs"><code>X = torch.from_numpy(Nx)
Y = torch.from_numpy(Ny)
X = X.float()
Y = Y.float()
lr = <span class="hljs-number">1e-5</span>
iA, iB = torch.Tensor([<span class="hljs-number">0</span>]), torch.Tensor([<span class="hljs-number">0</span>])
<span class="hljs-comment"># 需要计算梯度</span>
iA.requires_grad = <span class="hljs-literal">True</span>
iB.requires_grad = <span class="hljs-literal">True</span>

<span class="hljs-comment"># 记录最好的结果</span>
best_loss = float(<span class="hljs-string">"inf"</span>)
best_a = <span class="hljs-number">0.0</span>
best_b = <span class="hljs-number">0.0</span>
loss_list = []
max_epochs = <span class="hljs-number">1000</span>

<span class="hljs-comment"># 梯度下降</span>
<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(max_epochs):
    <span class="hljs-comment"># 计算 loss</span>
    loss = torch.mean((iA*X-Y+iB)**<span class="hljs-number">2</span>/(iA**<span class="hljs-number">2</span>+<span class="hljs-number">1</span>))
    <span class="hljs-comment"># 反向传播</span>
    loss.backward()
    <span class="hljs-comment"># 更新参数</span>
    <span class="hljs-keyword">with</span> torch.no_grad():
        iA -= lr*iA.grad
        iB -= lr*iB.grad
        cur_loss = loss.item()
        <span class="hljs-keyword">if</span> cur_loss&lt;best_loss:
            best_a = iA.item()
            best_b = iB.item()
            best_loss = cur_loss
        iA.grad.zero_()
        iB.grad.zero_()
        loss_list.append(cur_loss)

<span class="hljs-comment"># loss 曲线</span>
plt.plot(list(range(max_epochs)), loss_list)
plt.show()
</code></pre>
<p><img src="data:image/png;base64,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" alt="png"></p>
<pre class="hljs"><code>best_a, best_b, best_loss
</code></pre>
<pre><code>(2.505525827407837, 0.027117641642689705, 4.3863372802734375)
</code></pre>
<pre class="hljs"><code>nX = np.linspace(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>,endpoint=<span class="hljs-literal">True</span>)
plt.plot(nX, best_a*nX+best_b)
plt.scatter(Nx, Ny, marker=<span class="hljs-string">'.'</span>, color=<span class="hljs-string">'r'</span>)
plt.show()
</code></pre>
<p><img src="data:image/png;base64,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" alt="png"></p>
<p>最后可以看到拟合效果已经很好了。调节 learning rate 和最大迭代次数可以获得更好的效果，loss 曲线最后又增大是因为可能在最小值点，loss 震荡，无法到达最小值点。这点可以参考我的梯度下降的理解博客。</p>
<p>当 learning rate 为 1e-5 时，可以获得很好的效果，而如果不调大迭代次数，1e-6 的学习率效果不是很好。<strong>总结就是梯度下降法初始学习率和应用 learning rate deacy 非常重要。</strong></p>


  </div>
    <script>
        var posts = document.getElementsByClassName('post_href')[0].getElementsByTagName('a');
        for (var i=0; i<posts.length; i++)
            posts[i].setAttribute('target', '_blank');
    </script>
</div>

                <script data-isso="https://hzzone.me/isso"
                        src="https://hzzone.me/isso/js/embed.min.js"></script>

                <div class="comments">
                    <section id="isso-thread"></section>
                </div>
            </div>

        </div>
        <script type="text/javascript">const navToggle = document.getElementById('site-nav-toggle');
            navToggle.addEventListener('click',
            function() {
                let aboutContent = document.getElementById('nav-content');
                if (!aboutContent.classList.contains('show-block')) {
                    aboutContent.classList.add('show-block');
                    aboutContent.classList.remove('hide-block');
                } else {
                    aboutContent.classList.add('hide-block');
                    aboutContent.classList.remove('show-block');
                }
            });</script>
    <script type="text/javascript">
  window.MathJax = {
    jax: ["input/TeX","input/MathML","input/AsciiMath","output/CommonHTML"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    },
    CommonHTML: { linebreaks: { automatic: true } },
    "HTML-CSS": { linebreaks: { automatic: true } },
         SVG: { linebreaks: { automatic: true } }
  };
</script>
    <script>
        var domDiv = document.getElementById('progress-bar');
        //domH:可视区域的高度
        var domH = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
        window.addEventListener('scroll',function(){
            var pageHeight = Math.max(
             document.body.scrollHeight,
             document.documentElement.scrollHeight,
             document.body.offsetHeight,
             document.documentElement.offsetHeight,
             document.documentElement.clientHeight
            );
            domDiv.style.width = Math.round(pageYOffset/(pageHeight-domH)*100)+'%';
        },false);

    </script>
    </body>

</html>